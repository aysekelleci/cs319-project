 {% extends 'accounts/navbar.html' %}
{% load static %}
 {% load crispy_forms_tags %}

{% block stylesheet %}
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <link rel="stylesheet" href="{% static 'detail-post.css' %}">
{% endblock %}

{% block header_content %}
 <div class="header" style="margin-bottom: 20px;">Post: {{post.topic}}</div>
{% endblock %}

{% block page_content %}
<div class="page_content">

            <div class="heading" >
                <h1 class="head"> Replies </h1>
            </div>

            <div class="bottom-forum" >
                <div class="forum-title" style="border: solid 2px black">
                      {% if response.user.student %}
                     <a href="../../profile/{{post.user.student.pk}}"><img src="../../static/user.png" alt="user" class="reply-user-photo"></a>
                      {%endif%}

                    <div style="width: 95%;">
                        <p > {{post.user.name}}: {{post.date}}</p>
                        <h2>
                            {{post.topic}}
                        </h2>
                        <p> {{post.text}}</p>
                    </div>
                    <div >
                        <button class="reply-btn-on-heading" onclick="openTextFieldToReply()">
                             <img src="../../static/respond_icon.png" alt="open" class = "reply-icon" >
                        </button>
                    </div>
                </div>
                <div class="forum-reply-content" id="forum-reply-content">
                    <div >
                        <form id="new-reply-container" method="post" enctype="multipart/form-data">
                            {%                                             csrf_token %}
                            {{response_form|crispy}}
                            <button style="width: 120px; height: 40px;" class="btn btn-primary my-4" type="submit">Add Response</button>
                        </form>

                    </div>
                </div>

                 {% for response in responses %}
                <tr >
                    <div style="width: 100%">
                        <div style="width: 97%; " class="single-reply-content">
                             {% if response.user.student %}
                            <a href="../../profile/{{response.user.student.pk}}">
                                {%endif%}

                                <img src="../../static/user.png" alt="user" class="reply-user-photo">
                            </a>
                            <div class = "single-reply-text-content">
                                <p > {{response.user.name}}: {{response.date}}</p>
                                {{response.text}}
                            </div>
                            {% if forum_user.user.name == response.user.name %}
                        <div style="padding-right: 0px">

                            <a href="../../delete-response/{{response.pk}}">
                                <input type="submit" value="delete" id="rebtn" >
                            </a>
                        </div>
                          {%endif%}
                        </div>

                    </div>
                </tr>
                {%endfor%}



            </div>


</div>

<script>

function openReplies() {

    element = document.getElementById("reply-visbility");
    hidden = element.getAttribute("hidden");

    if( hidden )
        element.removeAttribute("hidden");
    else
        element.setAttribute("hidden", "hidden");

}
function openTextFieldToReply() {
    element = document.getElementById("forum-reply-content");
    hidden = element.getAttribute("hidden");

    if( hidden )
        element.removeAttribute("hidden");
    else
        element.setAttribute("hidden", "hidden");

}


</script>
{% endblock %}